!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i)}:e(window.jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{quickInsertButtons:["image","table","ul","ol","hr"],quickInsertTags:["p","div","h1","h2","h3","h4","h5","h6","pre","blockquote"]}),e.FE.QUICK_INSERT_BUTTONS={image:{icon:"insertImage",callback:function(){var t=this;t.shared.$qi_image_input||(t.shared.$qi_image_input=e('<input accept="image/*" name="quickInsertImage'+this.id+'" style="display: none;" type="file">'),e("body:first").append(t.shared.$qi_image_input),t.events.$on(t.shared.$qi_image_input,"change",function(){var t=e(this).data("inst");this.files&&(t.quickInsert.hide(),t.image.upload(this.files)),e(this).val("")},!0)),t.$qi_image_input=t.shared.$qi_image_input,t.helpers.isMobile()&&t.selection.save(),t.$qi_image_input.data("inst",t).trigger("click")},requiredPlugin:"image",title:"Insert Image"},table:{icon:"insertTable",callback:function(){this.quickInsert.hide(),this.table.insert(2,2),this.undo.saveStep()},requiredPlugin:"table",title:"Insert Table"},ol:{icon:"formatOL",callback:function(){this.quickInsert.hide(),this.lists.format("OL"),this.undo.saveStep()},requiredPlugin:"lists",title:"Ordered List"},ul:{icon:"formatUL",callback:function(){this.quickInsert.hide(),this.lists.format("UL"),this.undo.saveStep()},requiredPlugin:"lists",title:"Unordered List"},hr:{icon:"insertHR",callback:function(){this.quickInsert.hide(),this.commands.insertHR(),this.undo.saveStep()},title:"Insert Horizontal Line"}},e.FE.DefineIcon("quickInsert",{PATH:'<path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/>',template:"svg"}),e.FE.RegisterQuickInsertCommand=function(t,i){e.FE.QUICK_INSERT_BUTTONS[t]=i},e.FE.PLUGINS.quickInsert=function(t){function i(e){var i,s,n;i=e.offset().top-t.$box.offset().top,s=0-c.outerWidth(),n=(c.outerHeight()-e.outerHeight())/2,t.opts.iframe&&(i+=t.$iframe.offset().top-t.helpers.scrollTop()),c.hasClass("fr-on")&&i>=0&&u.css("top",i-n),i>=0&&i-n<=t.$box.outerHeight()-e.outerHeight()?(c.hasClass("fr-hidden")&&(c.hasClass("fr-on")&&o(),c.removeClass("fr-hidden")),c.css("top",i-n)):c.hasClass("fr-visible")&&(c.addClass("fr-hidden"),r()),c.css("left",s)}function s(e){c||l(),c.hasClass("fr-on")&&r(),t.$box.append(c),i(e),c.data("tag",e),c.addClass("fr-visible")}function n(){if(t.core.hasFocus()){var i=t.selection.element();t.node.isBlock(i)||(i=t.node.blockParent(i)),i&&t.node.isEmpty(i)&&t.node.isElement(i.parentNode)&&t.opts.quickInsertTags.indexOf(i.tagName.toLowerCase())>=0?c&&c.data("tag").is(e(i))&&c.hasClass("fr-on")?r():t.selection.isCollapsed()&&s(e(i)):a()}}function a(){c&&(t.html.checkIfEmpty(),c.hasClass("fr-on")&&r(),c.removeClass("fr-visible fr-on"),c.css("left",-9999).css("top",-9999))}function o(i){if(i&&i.preventDefault(),c.hasClass("fr-on")&&!c.hasClass("fr-hidden"))r();else{if(!t.shared.$qi_helper){for(var s=t.opts.quickInsertButtons,n='<div class="fr-qi-helper">',a=0,o=0;o<s.length;o++){var l=e.FE.QUICK_INSERT_BUTTONS[s[o]];l&&(!l.requiredPlugin||e.FE.PLUGINS[l.requiredPlugin]&&t.opts.pluginsEnabled.indexOf(l.requiredPlugin)>=0)&&(n+='<a class="fr-btn fr-floating-btn" role="button" title="'+t.language.translate(l.title)+'" tabIndex="-1" data-cmd="'+s[o]+'" style="transition-delay: '+.025*a+++'s;">'+t.icon.create(l.icon)+"</a>")}n+="</div>",t.shared.$qi_helper=e(n),t.tooltip.bind(t.shared.$qi_helper,"> a.fr-btn")}u=t.shared.$qi_helper,u.appendTo(t.$box),setTimeout(function(){u.css("top",parseFloat(c.css("top"))),u.css("left",parseFloat(c.css("left"))+c.outerWidth()),u.find("a").addClass("fr-size-1"),c.addClass("fr-on")},10)}}function r(){var e=t.$box.find(".fr-qi-helper");e.length&&(e.find("a").removeClass("fr-size-1"),e.css("left",-9999),c.hasClass("fr-hidden")||c.removeClass("fr-on"))}function l(){t.shared.$quick_insert||(t.shared.$quick_insert=e('<div class="fr-quick-insert"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+t.language.translate("Quick Insert")+'">'+t.icon.create("quickInsert")+"</a></div>")),c=t.shared.$quick_insert,t.tooltip.bind(t.$box,".fr-quick-insert > a.fr-floating-btn"),t.events.on("destroy",function(){c.removeClass("fr-on").appendTo(e("body:first")).css("left",-9999).css("top",-9999),u&&(r(),u.appendTo(e("body:first")))},!0),t.events.on("shared.destroy",function(){c.html("").removeData().remove(),c=null,u&&(u.html("").removeData().remove(),u=null)},!0),t.events.on("commands.before",a),t.events.on("commands.after",function(){t.popups.areVisible()||n()}),t.events.bindClick(t.$box,".fr-quick-insert > a",o),t.events.bindClick(t.$box,".fr-qi-helper > a.fr-btn",function(i){var s=e(i.currentTarget).data("cmd");e.FE.QUICK_INSERT_BUTTONS[s].callback.apply(t,[i.currentTarget])}),t.events.$on(t.$wp,"scroll",function(){c.hasClass("fr-visible")&&i(c.data("tag"))})}function d(){if(!t.$wp)return!1;t.opts.iframe&&t.$el.parent("html").find("head").append('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">'),t.popups.onShow("image.edit",a),t.events.on("mouseup",n),t.helpers.isMobile()&&t.events.$on(e(t.o_doc),"selectionchange",n),t.events.on("blur",a),t.events.on("keyup",n),t.events.on("keydown",function(){setTimeout(function(){n()},0)})}var c,u;return{_init:d,hide:a}}});